{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { MAZE, GAME_STATES, INITIAL_GHOSTS, INITIAL_PLAYER_POSITION } from '../constants/gameConstants';\nexport const useGameLogic = () => {\n  _s();\n  const [shiroPosition, setShiroPosition] = useState(INITIAL_PLAYER_POSITION);\n  const [maze, setMaze] = useState(MAZE);\n  const [score, setScore] = useState(0);\n  const [highScore, setHighScore] = useState(parseInt(localStorage.getItem('shiroNekoHighScore') || '0'));\n  const [lives, setLives] = useState(3);\n  const [level, setLevel] = useState(1);\n  const [gameState, setGameState] = useState(GAME_STATES.READY);\n  const [direction, setDirection] = useState({\n    x: 0,\n    y: 0\n  });\n  const [powerMode, setPowerMode] = useState(false);\n  const [powerModeTimer, setPowerModeTimer] = useState(0);\n  const [gameTime, setGameTime] = useState(0);\n  const [ghosts, setGhosts] = useState(INITIAL_GHOSTS);\n  const [totalDots, setTotalDots] = useState(0);\n  const [dotsEaten, setDotsEaten] = useState(0);\n  const gameLoopRef = useRef();\n  const powerModeRef = useRef();\n\n  // Inicializar puntos totales\n  useEffect(() => {\n    const dots = MAZE.flat().filter(cell => cell === 2 || cell === 3).length;\n    setTotalDots(dots);\n  }, []);\n\n  // Verificar colisiones con fantasmas\n  const checkGhostCollision = useCallback(position => {\n    return ghosts.some(ghost => ghost.x === position.x && ghost.y === position.y);\n  }, [ghosts]);\n\n  // Mover Shiro Neko\n  const moveShiro = useCallback(newDirection => {\n    if (gameState !== GAME_STATES.PLAYING) return;\n    setShiroPosition(prev => {\n      const newX = prev.x + newDirection.x;\n      const newY = prev.y + newDirection.y;\n      if (newX < 0 || newX >= 20 || newY < 0 || newY >= 20) return prev;\n      if (maze[newY][newX] === 1) return prev;\n      const newPosition = {\n        x: newX,\n        y: newY\n      };\n\n      // Verificar colisión con fantasmas\n      if (checkGhostCollision(newPosition)) {\n        if (powerMode) {\n          setScore(s => s + 200);\n          setGhosts(prevGhosts => prevGhosts.map(ghost => ghost.x === newX && ghost.y === newY ? {\n            ...ghost,\n            x: 9,\n            y: 9,\n            mode: 'frightened'\n          } : ghost));\n        } else {\n          setLives(l => l - 1);\n          if (lives <= 1) {\n            if (score > highScore) {\n              setHighScore(score);\n              localStorage.setItem('shiroNekoHighScore', score.toString());\n            }\n            setGameState(GAME_STATES.GAME_OVER);\n          } else {\n            setShiroPosition(INITIAL_PLAYER_POSITION);\n            setGhosts(INITIAL_GHOSTS);\n          }\n          return prev;\n        }\n      }\n\n      // Comer comida\n      if (maze[newY][newX] === 2 || maze[newY][newX] === 3) {\n        const isPowerPellet = maze[newY][newX] === 3;\n        const points = isPowerPellet ? 50 : 10;\n        setScore(s => s + points);\n        setDotsEaten(d => d + 1);\n        if (isPowerPellet) {\n          setPowerMode(true);\n          setPowerModeTimer(8000);\n          setGhosts(prevGhosts => prevGhosts.map(ghost => ({\n            ...ghost,\n            mode: 'frightened'\n          })));\n        }\n        setMaze(prevMaze => {\n          const newMaze = [...prevMaze];\n          newMaze[newY] = [...newMaze[newY]];\n          newMaze[newY][newX] = 0;\n          return newMaze;\n        });\n      }\n      return newPosition;\n    });\n  }, [gameState, maze, ghosts, powerMode, lives, checkGhostCollision, score, highScore]);\n\n  // Reiniciar juego\n  const resetGame = useCallback(() => {\n    setShiroPosition(INITIAL_PLAYER_POSITION);\n    setMaze(MAZE);\n    setScore(0);\n    setLives(3);\n    setLevel(1);\n    setGameState(GAME_STATES.READY);\n    setDirection({\n      x: 0,\n      y: 0\n    });\n    setPowerMode(false);\n    setPowerModeTimer(0);\n    setDotsEaten(0);\n    setGameTime(0);\n    setGhosts(INITIAL_GHOSTS);\n  }, []);\n  return {\n    // Estado del juego\n    shiroPosition,\n    maze,\n    score,\n    highScore,\n    lives,\n    level,\n    gameState,\n    direction,\n    powerMode,\n    powerModeTimer,\n    gameTime,\n    ghosts,\n    totalDots,\n    dotsEaten,\n    // Referencias\n    gameLoopRef,\n    powerModeRef,\n    // Funciones\n    setGameState,\n    setDirection,\n    moveShiro,\n    resetGame,\n    checkGhostCollision\n  };\n};\n_s(useGameLogic, \"drgUwpiOmx1w7kH8Pt0WakoKT+4=\");","map":{"version":3,"names":["useState","useEffect","useCallback","useRef","MAZE","GAME_STATES","INITIAL_GHOSTS","INITIAL_PLAYER_POSITION","useGameLogic","_s","shiroPosition","setShiroPosition","maze","setMaze","score","setScore","highScore","setHighScore","parseInt","localStorage","getItem","lives","setLives","level","setLevel","gameState","setGameState","READY","direction","setDirection","x","y","powerMode","setPowerMode","powerModeTimer","setPowerModeTimer","gameTime","setGameTime","ghosts","setGhosts","totalDots","setTotalDots","dotsEaten","setDotsEaten","gameLoopRef","powerModeRef","dots","flat","filter","cell","length","checkGhostCollision","position","some","ghost","moveShiro","newDirection","PLAYING","prev","newX","newY","newPosition","s","prevGhosts","map","mode","l","setItem","toString","GAME_OVER","isPowerPellet","points","d","prevMaze","newMaze","resetGame"],"sources":["C:/Users/usuario/Downloads/juego/src/hooks/useGameLogic.js"],"sourcesContent":["import { useState, useEffect, useCallback, useRef } from 'react';\nimport { MAZE, GAME_STATES, INITIAL_GHOSTS, INITIAL_PLAYER_POSITION } from '../constants/gameConstants';\n\nexport const useGameLogic = () => {\n  const [shiroPosition, setShiroPosition] = useState(INITIAL_PLAYER_POSITION);\n  const [maze, setMaze] = useState(MAZE);\n  const [score, setScore] = useState(0);\n  const [highScore, setHighScore] = useState(parseInt(localStorage.getItem('shiroNekoHighScore') || '0'));\n  const [lives, setLives] = useState(3);\n  const [level, setLevel] = useState(1);\n  const [gameState, setGameState] = useState(GAME_STATES.READY);\n  const [direction, setDirection] = useState({ x: 0, y: 0 });\n  const [powerMode, setPowerMode] = useState(false);\n  const [powerModeTimer, setPowerModeTimer] = useState(0);\n  const [gameTime, setGameTime] = useState(0);\n  const [ghosts, setGhosts] = useState(INITIAL_GHOSTS);\n  const [totalDots, setTotalDots] = useState(0);\n  const [dotsEaten, setDotsEaten] = useState(0);\n  \n  const gameLoopRef = useRef();\n  const powerModeRef = useRef();\n\n  // Inicializar puntos totales\n  useEffect(() => {\n    const dots = MAZE.flat().filter(cell => cell === 2 || cell === 3).length;\n    setTotalDots(dots);\n  }, []);\n\n  // Verificar colisiones con fantasmas\n  const checkGhostCollision = useCallback((position) => {\n    return ghosts.some(ghost => ghost.x === position.x && ghost.y === position.y);\n  }, [ghosts]);\n\n  // Mover Shiro Neko\n  const moveShiro = useCallback((newDirection) => {\n    if (gameState !== GAME_STATES.PLAYING) return;\n    \n    setShiroPosition(prev => {\n      const newX = prev.x + newDirection.x;\n      const newY = prev.y + newDirection.y;\n      \n      if (newX < 0 || newX >= 20 || newY < 0 || newY >= 20) return prev;\n      if (maze[newY][newX] === 1) return prev;\n      \n      const newPosition = { x: newX, y: newY };\n      \n      // Verificar colisión con fantasmas\n      if (checkGhostCollision(newPosition)) {\n        if (powerMode) {\n          setScore(s => s + 200);\n          setGhosts(prevGhosts => \n            prevGhosts.map(ghost => \n              ghost.x === newX && ghost.y === newY \n                ? { ...ghost, x: 9, y: 9, mode: 'frightened' }\n                : ghost\n            )\n          );\n        } else {\n          setLives(l => l - 1);\n          if (lives <= 1) {\n            if (score > highScore) {\n              setHighScore(score);\n              localStorage.setItem('shiroNekoHighScore', score.toString());\n            }\n            setGameState(GAME_STATES.GAME_OVER);\n          } else {\n            setShiroPosition(INITIAL_PLAYER_POSITION);\n            setGhosts(INITIAL_GHOSTS);\n          }\n          return prev;\n        }\n      }\n      \n      // Comer comida\n      if (maze[newY][newX] === 2 || maze[newY][newX] === 3) {\n        const isPowerPellet = maze[newY][newX] === 3;\n        const points = isPowerPellet ? 50 : 10;\n        setScore(s => s + points);\n        setDotsEaten(d => d + 1);\n        \n        if (isPowerPellet) {\n          setPowerMode(true);\n          setPowerModeTimer(8000);\n          setGhosts(prevGhosts => \n            prevGhosts.map(ghost => ({ ...ghost, mode: 'frightened' }))\n          );\n        }\n        \n        setMaze(prevMaze => {\n          const newMaze = [...prevMaze];\n          newMaze[newY] = [...newMaze[newY]];\n          newMaze[newY][newX] = 0;\n          return newMaze;\n        });\n      }\n      \n      return newPosition;\n    });\n  }, [gameState, maze, ghosts, powerMode, lives, checkGhostCollision, score, highScore]);\n\n  // Reiniciar juego\n  const resetGame = useCallback(() => {\n    setShiroPosition(INITIAL_PLAYER_POSITION);\n    setMaze(MAZE);\n    setScore(0);\n    setLives(3);\n    setLevel(1);\n    setGameState(GAME_STATES.READY);\n    setDirection({ x: 0, y: 0 });\n    setPowerMode(false);\n    setPowerModeTimer(0);\n    setDotsEaten(0);\n    setGameTime(0);\n    setGhosts(INITIAL_GHOSTS);\n  }, []);\n\n  return {\n    // Estado del juego\n    shiroPosition,\n    maze,\n    score,\n    highScore,\n    lives,\n    level,\n    gameState,\n    direction,\n    powerMode,\n    powerModeTimer,\n    gameTime,\n    ghosts,\n    totalDots,\n    dotsEaten,\n    \n    // Referencias\n    gameLoopRef,\n    powerModeRef,\n    \n    // Funciones\n    setGameState,\n    setDirection,\n    moveShiro,\n    resetGame,\n    checkGhostCollision\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}